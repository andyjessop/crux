function m(){const n=[];return{emit:a,on:d,onAll:s,once:y,off:u,offAll:S};function d(o,i){const r={handler:i,type:o};return n.push(r),()=>u(o,i)}function s(o){const i={handler:o,type:"all"};n.push(i)}function a(o,i){let r;const c=[];for(r of n){if(r.type!==o&&r.type!=="all")continue;const h=r.handler(i);h!=null&&h.then&&c.push(h)}return Promise.all(c)}function u(o,i){const r=n.findIndex(c=>o===c.type&&i===c.handler);r!==-1&&n.splice(r,1)}function S(o){const i=n.findIndex(r=>r.type==="all"&&o===r.handler);i!==-1&&n.splice(i,1)}function y(o,i){const r={handler:(...c)=>{u(o,r.handler),i(...c)},type:o};n.push(r)}}function $(n,d,s){let a,u;const S=Object.keys(s),y=S.reduce((e,t)=>(e[t]=h(t),e),{}),o=T(y),i=S.reduce((e,t)=>{const l=function(...f){return{payload:s[t].length>2?f:f[0],type:y[t]}};return l.type=y[t],e[t]=l,e},{}),r=Object.entries(i).reduce((e,[t,l])=>(e[t]=function(...f){if(!a)throw`${n} slice middleware has not yet been registered with the store. Dispatch is not available.`;const p=l(...f),b=c();a(p);const x=c();return e.emit(t,p.payload),b!==x},e),{...m(),getState:c});return{actions:i,api:r,middleware:g,reducer:v};function c(){if(!u)throw`${n} slice middleware has not yet been registered with the store. getState is not available.`;return u()[n]}function h(e){return`${n}/${e}`}function w(e){return o[e]!==void 0}function g(e){return u||(u=e.getState),a||(a=e.dispatch),t=>l=>t(l)}function v(e,t){const[l]=t.type.split("/"),f=e||d;if(w(t.type)){const p=o[t.type];return l!==n||!s[p]?e!=null?e:d:s[p].length>2?s[p](f,...t.payload):s[p](f,t.payload)}return f}}function T(n){const d={};for(const s in n)d[n[s]]=s;return d}export{$ as c};
