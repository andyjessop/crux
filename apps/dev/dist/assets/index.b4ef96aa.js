(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerpolicy&&(s.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?s.credentials="include":n.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();const le="modulepreload",pe=function(t){return"/"+t},B={},R=function(e,r,o){return!r||r.length===0?e():Promise.all(r.map(n=>{if(n=pe(n),n in B)return;B[n]=!0;const s=n.endsWith(".css"),c=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${c}`))return;const i=document.createElement("link");if(i.rel=s?"stylesheet":le,s||(i.as="script",i.crossOrigin=""),i.href=n,document.head.appendChild(i),s)return new Promise((a,f)=>{i.addEventListener("load",a),i.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${n}`)))})})).then(()=>e())};function ye(){const t=[];let e=!1;return{add:r,clear:o,entries:t,flush:n};function r(s,...c){let i=()=>{},a=()=>{};const f=new Promise((l,g)=>{a=l,i=g});return t.push({fn:s,params:c,reject:i,resolve:a}),f}function o(){e=!1,t.length=0}async function n(){if(e)return;const s=t[0];if(!!s){e=!0;try{const c=await s.fn(...s.params);return s.resolve(c),t.shift(),e=!1,n()}catch(c){s.reject(c)}}}}function he(t,e){const r=Array.from(t.keys());return e.every(o=>r.includes(o))}function we(t,e){let r=t.length;for(;r--;)if(e(t[r],r,t))return r;return-1}function ve(t){const e=[],r=t.map(([o,n])=>n.deps||[]);for(const o of t){const n=we(r,s=>me(s,o[1].deps||[]));n!==-1?e.splice(n,0,o):e.unshift(o)}return e}function me(t,e){return e.some(r=>t.includes(r))}function _e(t,e){const r=e.entries(),o=[];for(const[n,s]of r)s.deps.includes(t)&&o.push(t);return o}function Oe(t){const e=new Map;return t&&ve(Object.entries(t)).forEach(([a,f])=>{r(a,f)}),{get:o,getSingleton:n,register:r,remove:c};function r(i,a){if(e.get(i))return!1;const f=Object.keys(e).length,{factory:l,deps:g=[]}=a;return he(e,g)?(e.set(i,{factory:l,deps:g,name:i,order:f}),!0):!1}async function o(i){var a,f;if(!e.has(i))throw`Service ${i} does not exist.`;return(a=e.get(i))!=null&&a.instance||await s(i),(f=e.get(i))==null?void 0:f.instance}async function n(i){if(!e.get(i))throw new Error(`Service ${i} does not exist.`);return s(i,!0)}async function s(i,a=!1){if(!e.get(i))throw new Error("Service does not exist");const f=e.get(i);if(f.instance&&!a)return f.instance;const l=f.deps,g=await Promise.all(l.map(C=>s(C))),A=await(await f.factory())(...g);return a||(f.instance=A),A}function c(i){var f,l;return!e.has(i)||_e(i,e).length?null:((l=(f=e.get(i).instance)==null?void 0:f.destroy)==null||l.call(f),e.delete(i),!0)}}function Ee(t=10){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";return new Array(t).fill(0).reduce(r=>r+e.charAt(Math.floor(Math.random()*e.length)),"")}function ge(t,{initialState:e,name:r}){const o=Object.keys(t),n=r||Ee(20);return{actions:o.reduce((c,i)=>{const a=s(i),f=function(l){return{payload:l,type:a}};return f.type=a,c[i]=f,c},{}),reducer:(c,i)=>{const[a,...f]=i.type.split("/"),l=f.join("/");return a!==n||!t[l]?c!=null?c:e:t[l](c||e,i.payload)}};function s(c){return`${n}/${c}`}}function be(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function K(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,o)}return r}function W(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?K(Object(r),!0).forEach(function(o){be(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):K(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}function E(t){return"Minified Redux error #"+t+"; visit https://redux.js.org/Errors?code="+t+" for the full message or use the non-minified dev environment for full errors. "}var F=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),k=function(){return Math.random().toString(36).substring(7).split("").join(".")},V={INIT:"@@redux/INIT"+k(),REPLACE:"@@redux/REPLACE"+k(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+k()}};function Se(t){if(typeof t!="object"||t===null)return!1;for(var e=t;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function G(t,e,r){var o;if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(E(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(E(1));return r(G)(t,e)}if(typeof t!="function")throw new Error(E(2));var n=t,s=e,c=[],i=c,a=!1;function f(){i===c&&(i=c.slice())}function l(){if(a)throw new Error(E(3));return s}function g(p){if(typeof p!="function")throw new Error(E(4));if(a)throw new Error(E(5));var b=!0;return f(),i.push(p),function(){if(!!b){if(a)throw new Error(E(6));b=!1,f();var L=i.indexOf(p);i.splice(L,1),c=null}}}function P(p){if(!Se(p))throw new Error(E(7));if(typeof p.type>"u")throw new Error(E(8));if(a)throw new Error(E(9));try{a=!0,s=n(s,p)}finally{a=!1}for(var b=c=i,M=0;M<b.length;M++){var L=b[M];L()}return p}function A(p){if(typeof p!="function")throw new Error(E(10));n=p,P({type:V.REPLACE})}function C(){var p,b=g;return p={subscribe:function(L){if(typeof L!="object"||L===null)throw new Error(E(11));function j(){L.next&&L.next(l())}j();var $=b(j);return{unsubscribe:$}}},p[F]=function(){return this},p}return P({type:V.INIT}),o={dispatch:P,subscribe:g,getState:l,replaceReducer:A},o[F]=C,o}var Re=G;function Ae(t){Object.keys(t).forEach(function(e){var r=t[e],o=r(void 0,{type:V.INIT});if(typeof o>"u")throw new Error(E(12));if(typeof r(void 0,{type:V.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(E(13))})}function X(t){for(var e=Object.keys(t),r={},o=0;o<e.length;o++){var n=e[o];typeof t[n]=="function"&&(r[n]=t[n])}var s=Object.keys(r),c;try{Ae(r)}catch(i){c=i}return function(a,f){if(a===void 0&&(a={}),c)throw c;for(var l=!1,g={},P=0;P<s.length;P++){var A=s[P],C=r[A],p=a[A],b=C(p,f);if(typeof b>"u")throw f&&f.type,new Error(E(14));g[A]=b,l=l||b!==p}return l=l||s.length!==Object.keys(a).length,l?g:a}}function U(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return e.length===0?function(o){return o}:e.length===1?e[0]:e.reduce(function(o,n){return function(){return o(n.apply(void 0,arguments))}})}function Pe(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return function(o){return function(){var n=o.apply(void 0,arguments),s=function(){throw new Error(E(15))},c={getState:n.getState,dispatch:function(){return s.apply(void 0,arguments)}},i=e.map(function(a){return a(c)});return s=U.apply(void 0,i)(n.dispatch),W(W({},n),{},{dispatch:s})}}}const Ne=()=>{const t=[];return{middleware:({getState:e,dispatch:r})=>o=>n=>{const s={getState:e,dispatch:i=>r(i)},c=t.map(i=>i(s));return U(...c)(o)(n)},add:(e,r)=>(r===void 0?t.push(e):t.splice(r,0,e),()=>{const o=t.findIndex(n=>n===e);o<0||t.splice(o,1)}),getIndex:e=>t.findIndex(r=>r===e)}},De=()=>{const t=new Map;let e=o=>o||{};return{add:r,reducer:(o,n)=>e(o,n)};function r(o,n){return t.set(o,n),e=X(Object.fromEntries(t)),function(){t.delete(o),e=X(Object.fromEntries(t))}}};function Le({isDev:t}={isDev:!0}){const e=Ne(),r=De(),o=e.add,n=r.add,s=Pe(e.middleware),c=t&&typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||U,i=Re(r.reducer,{},c(s));return{addMiddleware:o,addReducer:n,store:i}}function Ie(...t){if(t.length===1)return t[0];const e=new Set;for(const r of t)for(const o of r)t.every(n=>n.has(o))&&e.add(o);return e}function Q(t,e){const r=Ie(t,e),o=new Set;for(const n of t)r.has(n)||o.add(n);return o}async function Me(t,{logger:e}={}){const{addMiddleware:r,addReducer:o,store:n}=Le(),{layout:s,modules:c,root:i,services:a,views:f}=t,l=Oe(a),g=ie(),P=se(),A=ne(),C=oe(),p=new Map,b=ye(),M={};let L=!0;const{actions:j,reducer:$}=ge({initReducer:(u,h)=>u,initSlice:(u,h)=>u,setRegions:(u,h)=>({...u,regions:[...u.regions,...h]})},{initialState:{regions:[]},name:"__crux"});return o("__cruxCore",$),r(Y),await H(n.dispatch),L=!1,n.dispatch({type:"__crux/ready",payload:void 0}),{addMiddleware:r,addReducer:o,store:n};async function H(u){const h=await C.factory(),{middleware:y,reducer:v}=h();J("layout",u,{middleware:y,reducer:v}),u(j.initReducer("layout")),A.render=await A.factory()}function Y(u){return function(y){return async function(d){if(d.type===j.initReducer.type||d.type===j.setRegions.type||d.type===j.initSlice.type){e==null||e.log("info",JSON.stringify({message:"Is core action. Passing to reducers.",data:d})),y(d);return}if(L){e==null||e.log("info",JSON.stringify({message:"Crux is busy. Adding action to queue.",data:d})),b.add(u.dispatch,d);return}e==null||e.log("info",JSON.stringify({message:"Crux is not busy. Passing to reducers",data:d})),y(d);const N=await Z(u.getState(),u.dispatch);N.length&&(e==null||e.log("info",JSON.stringify({message:"New modules",data:N})));const S=await ee(u.getState());S&&(e==null||e.log("info",JSON.stringify({message:"New regions",data:S})),u.dispatch(j.setRegions(S))),await te(u.getState()),e==null||e.log("info",JSON.stringify({message:"Flushing queue",data:b.entries.map(w=>w.fn.name)})),b.flush()}}}function J(u,h,y){let v,d;if(!y)return()=>{};const{actions:N,middleware:S,reducer:w,services:m={},views:D={}}=y;for(const[_,O]of Object.entries(m))l.register(`${u}.${_}`,O);N&&(M[u]=Object.entries(N).reduce((_,[O,I])=>(_[O]=x=>h(I(x)),_),{})),S&&(v=r(S)),w&&(d=o(u,w));for(const[_,O]of Object.entries(D))P.set(_,q(O));return h(j.initSlice(u)),function(){N&&delete M[u];for(const[O,I]of Object.entries(D))P.delete(O);v==null||v(),d==null||d()}}async function Z(u,h){var v;const y=[];for(const d of g.keys()){const N=g.get(d),{deps:S=[],destroy:w,enabled:m,factory:D,unregister:_}=N,O=(v=m==null?void 0:m(u))!=null?v:!0,I=_,x=O&&!I;if(!O&&I&&(_==null||_(),w==null||w()),I&&O||!x)continue;const ue=await D(),ae=await Promise.all(S.map(de=>l.get(de))),fe=await ue(...ae);N.unregister=J(d,h,fe),y.push(d)}return y}async function ee(u){const{currentData:h,render:y,selectData:v}=A,d=v==null?void 0:v(u);return d===h?void 0:(A.currentData=d,await(y==null?void 0:y(i,d)),Array.from(document.querySelectorAll("[data-crux-root]")).filter(S=>S!==null).map(S=>S.getAttribute("data-crux-root")))}async function te(u){var S;const h=re(u),y=new Set(h),v=new Set(p.keys()),d=Q(v,y);for(const w of d){const m=p.get(w);!m||((S=m.destroy)==null||S.call(m),p.delete(w))}const N=Q(y,v);for(const w of N){const m=ce(P,"root",w);if(!m){e==null||e.log("debug",JSON.stringify({message:`No view found for root ${w}`}));continue}const D={...m},_=h.find(O=>O===w);D.rootEl=document.querySelector(`[data-crux-root=${_}`),D.render=await m.factory(),p.set(w,{...D})}for(const w of p.values()){const{currentData:m,render:D,root:_,rootEl:O,selectActions:I,selectData:x}=w,T=x==null?void 0:x(u);if(e==null||e.log("debug",JSON.stringify({message:`Current state for view ${_}`,data:JSON.stringify(T)})),T===m||O===void 0)return;w.currentData=T,await(D==null?void 0:D(O,T,I==null?void 0:I(M)))}}function re(u){return u.__cruxCore.regions}function ne(){return{...s.view,currentData:null}}function oe(){return{...s.module}}function ie(){return Object.entries(c).reduce((u,[h,y])=>(u.set(h,y),u),new Map)}function se(){return Object.entries(f).reduce((u,[h,y])=>(u.set(h,q(y)),u),new Map)}function q(u){return{...u,currentActions:null,currentData:null}}function ce(u,h,y){for(const[v,d]of u.entries())if(d[h]===y)return d}}const z={error:0,warn:1,info:2,http:3,verbose:4,debug:5,silly:6},je=t=>t.layout;Ce();async function Ce(){const t=document.getElementById("root");if(!t)throw"No root found!!";await Me({modules:{auth:{deps:["authApi"],factory:()=>R(()=>import("./auth.module.6a30a522.js"),["assets/auth.module.6a30a522.js","assets/event-emitter.2752b338.js","assets/machine.cc32e4a0.js"]).then(e=>e.createAuthModule)},darkMode:{deps:["darkMode"],factory:()=>R(()=>import("./dark-mode.module.330e247c.js"),[]).then(e=>e.createDarkModeModule)},data:{deps:["usersApi"],factory:()=>R(()=>import("./data.module.d9ac1905.js"),["assets/data.module.d9ac1905.js","assets/event-emitter.2752b338.js","assets/machine.cc32e4a0.js"]).then(e=>e.createDataModule)},router:{deps:["cache"],factory:()=>R(()=>import("./router.module.b594cd7d.js"),["assets/router.module.b594cd7d.js","assets/event-emitter.2752b338.js"]).then(e=>e.createRouterModule)},users:{deps:["data.users"],factory:()=>R(()=>import("./user.module.ff8d3fe7.js"),[]).then(e=>e.createUserModule)}},layout:{module:{factory:()=>R(()=>import("./layout.module.32522097.js"),[]).then(e=>e.createLayoutModule)},view:{selectData:je,factory:()=>R(()=>import("./layout.view.9d1088cb.js"),["assets/layout.view.9d1088cb.js","assets/layout.view.e10f7584.css","assets/lit-html.d638b774.js"]).then(e=>e.createLayoutView)}},root:t,services:{asyncCache:{factory:()=>R(()=>import("./async-cache.service.eafbb6c5.js"),[]).then(e=>e.createAsyncCacheService)},authApi:{factory:()=>R(()=>import("./api.ece7604c.js"),["assets/api.ece7604c.js","assets/env.service.e4b665b8.js"]).then(e=>e.createAuthApi),deps:["asyncCache","env"]},cache:{factory:()=>R(()=>import("./cache.service.a5a72e72.js"),[]).then(e=>e.createCacheService)},darkMode:{factory:()=>R(()=>import("./dark-mode.service.415a5cb0.js"),["assets/dark-mode.service.415a5cb0.js","assets/dark-mode.service.df3309cc.css"]).then(e=>e.createDarkModeService),deps:["cache"]},env:{factory:()=>R(()=>import("./env.service.e4b665b8.js"),[]).then(e=>e.env)},featureFlags:{factory:()=>R(()=>import("./feature-flags.service.acbfde49.js"),[]).then(e=>e.createFeatureFlagsService)},reporting:{factory:()=>R(()=>import("./logging.service.d183d238.js"),[]).then(e=>e.createReportingService)},usersApi:{factory:()=>R(()=>import("./users-api.service.7d765f0a.js"),[]).then(e=>e.createUsersApiService)}},views:{}},{logger:xe("debug")})}function xe(t){return{log:(e,r)=>{if(z[e]<=z[t]){const{data:o,message:n}=JSON.parse(r);console.info(n,o)}}}}export{R as _,ye as c,ge as s};
