import{Variable as s}from"./env.service.e4b665b8.js";function E(a,r){const e=new Headers;return e.set("Content-Type","application/json"),e.set("apiKey",r.get(s.VITE_PUBLIC_API_KEY)),{checkLocalUser:u,login:i,logout:c,refreshToken:h,signUp:f,user:_,verify:y};async function u(){const[t,n]=await Promise.all([a.get("crux-auth-jwt"),a.get("crux-auth-jwt-expiry"),a.get("crux-auth-jwt-refresh-token")]);return!n||n<Date.now()?(await Promise.all([a.remove("crux-auth-jwt"),a.remove("crux-auth-jwt-expiry")]),!1):(e.set("Authorization",`Bearer ${t}`),!0)}async function i(t,n){try{return(await fetch(`${r.get(s.VITE_API_BASE_URL)}/auth/v1/token?grant_type=password`,{headers:e,method:"POST",body:JSON.stringify({email:t,password:n})})).json()}catch{return!1}}async function c(){try{return(await fetch(`${r.get(s.VITE_API_BASE_URL)}/auth/v1/logout`,{headers:e,method:"POST"})).json()}catch{return!1}}async function h(){try{return(await fetch(`${r.get(s.VITE_API_BASE_URL)}/auth/v1/token?grant_type=refresh_token`,{headers:e,method:"POST",body:JSON.stringify({refresh_token:await a.get("crux-auth-jwt-refresh-token")})})).json()}catch{return!1}}async function f(t,n){try{return(await fetch(`${r.get(s.VITE_API_BASE_URL)}/auth/v1/signup`,{headers:e,method:"POST",body:JSON.stringify({email:t,password:n})})).json()}catch{return!1}}async function _(){try{return(await fetch(`${r.get(s.VITE_API_BASE_URL)}/auth/v1/user`,{headers:e,method:"GET"})).json()}catch{return!1}}async function y(t){try{return(await fetch(`${r.get(s.VITE_API_BASE_URL)}/auth/v1/verify?token=${t}&type=signup&redirect_to=$${r.get(s.VITE_API_SIGNUP_REDIRECT_URL)}`,{headers:e,method:"GET"})).json()}catch{return!1}}}export{E as createAuthApi};
