function v(){const n=[];return{emit:p,on:d,onAll:s,once:y,off:f,offAll:S};function d(i,o){const r={handler:o,type:i};return n.push(r),()=>f(i,o)}function s(i){const o={handler:i,type:"all"};n.push(o)}function p(i,o){let r;const c=[];for(r of n){if(r.type!==i&&r.type!=="all")continue;const h=r.handler(o);h!=null&&h.then&&c.push(h)}return Promise.all(c)}function f(i,o){const r=n.findIndex(c=>i===c.type&&o===c.handler);r!==-1&&n.splice(r,1)}function S(i){const o=n.findIndex(r=>r.type==="all"&&i===r.handler);o!==-1&&n.splice(o,1)}function y(i,o){const r={handler:(...c)=>{f(i,r.handler),o(...c)},type:i};n.push(r)}}function $(n,d,s){let p,f;const S=Object.keys(s),y=S.reduce((e,t)=>(e[t]=h(t),e),{}),i=x(y),o=S.reduce((e,t)=>{const l=function(...u){return{payload:s[t].length>2?u:u[0],type:y[t]}};return l.type=y[t],e[t]=l,e},{}),r=Object.entries(o).reduce((e,[t,l])=>(e[t]=async function(u){if(!p)throw`${n} slice middleware has not yet been registered with the store. Dispatch is not available.`;const a=l(u);p(l(u)),e.emit(t,a.payload)},e),{...v(),getState:c});return{actions:o,api:r,middleware:b,reducer:g};function c(){if(!f)throw`${n} slice middleware has not yet been registered with the store. getState is not available.`;return f()[n]}function h(e){return`${n}/${e}`}function w(e){return i[e]!==void 0}function b(e){return f||(f=e.getState),p||(p=e.dispatch),t=>l=>t(l)}function g(e,t){const[l]=t.type.split("/"),u=e||d;if(w(t.type)){const a=i[t.type];return l!==n||!s[a]?e!=null?e:d:s[a].length>2?s[a](u,...t.payload):s[a](u,t.payload)}return u}}function x(n){const d={};for(const s in n)d[n[s]]=s;return d}export{$ as c};
